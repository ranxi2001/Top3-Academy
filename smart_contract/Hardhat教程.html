<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <!-- 字符集和浏览器兼容性 -->
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">

<!-- SEO Meta Tags -->
<meta name="description" content="Web3顶级学习平台 | 智能合约开发、链上交互和前端DApp开发实战教程，从入门到精通！">
<meta name="keywords" content="Web3, 区块链, 智能合约, Solidity, DApp, 去中心化应用, 教程">
<meta name="author" content="Top3 Academy">

<!-- Open Graph -->
<meta property="og:title" content="Hardhat教程 | Top3 Academy">
<meta property="og:description" content="Web3顶级学习平台 | 智能合约开发、链上交互和前端DApp开发实战教程，从入门到精通！">
<meta property="og:type" content="website">
<meta property="og:url" content="https://learnweb3.top/smart_contract/Hardhat%E6%95%99%E7%A8%8B.html">

<!-- 页面标题 -->
<title>Hardhat教程 | Top3 Academy</title>

<!-- Favicon -->
<link rel="icon" type="image/png" href="/assets/img/logo.png">
<link rel="apple-touch-icon" href="/assets/img/logo.png">

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- 站点样式表 -->
<link rel="stylesheet" href="/assets/css/main.css">

<!-- 语法高亮 - Prism.js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-light">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
    id="prism-dark" disabled>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

<!-- 主题初始化脚本 (避免闪烁) -->
<script>
    (function () {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
    })();
</script>
</head>

<body>
    <header>
    <div class="container">
        <div id="branding">
            <a href="/" class="logo-link">
                <img src="/assets/img/logo.png" alt="Top3 Academy Logo" class="logo">
                <span class="site-title">Top3 Academy</span>
            </a>
        </div>

        <nav id="mainNav">
            <ul>
                <li><a href="/smart_contract/">智能合约</a></li>
                <li><a href="/chain_interaction/">链上交互</a></li>
                <li><a href="/Front-end_Interaction/">前端交互</a></li>
                <li><a href="/friends/">友情链接</a></li>
            </ul>
        </nav>

        <div class="header-actions">
            <!-- 主题切换按钮 -->
            <button class="theme-toggle" id="themeToggle" aria-label="切换主题">
                <svg class="sun-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z" />
                </svg>
                <svg class="moon-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z" />
                </svg>
            </button>

            <!-- 汉堡菜单按钮 (移动端) -->
            <button class="hamburger" id="menuToggle" aria-label="菜单">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </div>
</header>

    <!-- 侧边栏遮罩层 -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- 课程文档布局 -->
    <div class="course-document">
        <aside class="sidebar" id="sidebar">
            <h2>目录</h2>
            <nav class="lesson-nav">
                <ul>
                    
                    
                    
                    
                    
                    <li >
                        <a href="/smart_contract/Hardhat%E5%AE%9E%E6%88%98%E7%AF%87%E2%80%94%E2%80%94%E4%BB%8E%E9%9B%B6%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE.html">Hardhat实战篇——从零创建一个项目</a>
                    </li>
                    
                    
                    
                    
                    <li >
                        <a href="/smart_contract/Hardhat%E5%AE%9E%E6%88%98%E7%AF%87%E2%80%94%E2%80%94%E5%B0%86%E5%90%88%E7%BA%A6%E9%83%A8%E7%BD%B2%E5%88%B0%E6%B5%8B%E8%AF%95%E7%BD%91.html">Hardhat实战篇——将合约部署到测试网</a>
                    </li>
                    
                    
                    
                    
                    <li class="active" >
                        <a href="/smart_contract/Hardhat%E6%95%99%E7%A8%8B.html">Hardhat教程</a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    <li >
                        <a href="/smart_contract/%E9%98%85%E8%AF%BB%E4%BC%98%E7%A7%80%E7%9A%84%E5%90%88%E7%BA%A6%E4%BB%A3%E7%A0%81.html">阅读优秀的合约代码</a>
                    </li>
                    
                    
                </ul>
            </nav>
        </aside>

        <main class="content">
            <h1 id="hardhat教程">Hardhat教程</h1>

<h2 id="视频介绍">视频介绍</h2>

<p><strong><a href="https://www.bilibili.com/video/BV1jy4y1K7Tj/?share_source=copy_web&amp;vd_source=06d5516ee4f517472270277cac88fae0">Solidity 基础课第三节：使用Hardhat-测试与任务</a></strong></p>

<p><img src="./attachment/image-20241008204626295.png" alt="" /></p>

<h2 id="hardhat简介">Hardhat简介</h2>

<ul>
  <li>一个灵活、快速、可扩展的以太坊智能合约开发环境。</li>
  <li>当前最流行的开发框架</li>
  <li>最丰富的社区支持和插件生态</li>
</ul>

<h3 id="hardhat组成部分">Hardhat组成部分</h3>

<ul>
  <li>Hardhat Runner:Hardhati运行环境，核心为task和plugin</li>
  <li>Hardhat Network:开发使用的本地网络</li>
  <li>Hardhat VSCode:为VSCode中开发Solidityi设计的插件</li>
</ul>

<h3 id="为什么使用hardhat">为什么使用Hardhat</h3>

<ul>
  <li>无需配置网络环境，在本地开发智能合约并利用Hardhat Network 模拟部署和测试</li>
  <li>
    <p>丰富的Debug.工具，包括合约中使用console.log,以及返回详细的错误信息和堆栈追踪信息</p>
  </li>
  <li>灵活性：自由地配置项目并构建自己的Qsk</li>
  <li>
    <p>兼容性：可以和其他开发工具一起使用(Truffle,Foundry,DappTools))</p>
  </li>
  <li>扩展性：可以添加各种插件来扩展功能</li>
  <li>插件：拥有丰富的插件生态，活跃的社区支持</li>
</ul>

<p><img src="attachment/Hardhat与Remix对比.png" alt="" /></p>

<h2 id="准备工作">准备工作</h2>

<ul>
  <li>安装NodeJS
    <ul>
      <li>Hardhat是基于NodeJS的框架</li>
    </ul>
  </li>
  <li>选择你的代码编辑器
    <ul>
      <li>推荐SCode</li>
      <li>插件安装：Solidity</li>
    </ul>
  </li>
  <li>准备必要的Key和资产
    <ul>
      <li>注册BSCScanf的APIKey)用于验证合约代码</li>
      <li>领取BNB Testnet的测试token</li>
      <li>注册Coinmarketcapl的APIKey用于测试中显示gasFee(可选)</li>
    </ul>
  </li>
</ul>

<p><img src="./attachment/image-20241008210009949.png" alt="" /></p>

<h2 id="hardhat安装与设置">Hardhat安装与设置</h2>

<h3 id="新建一个nardhat项目">新建一个nardhat项目</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat
</code></pre></div></div>

<p><img src="./attachment/image-20241008210226679.png" alt="" /></p>

<h3 id="hardhat目录结构">Hardhat目录结构</h3>

<p><img src="./attachment/image-20241008210319720.png" alt="" /></p>

<h3 id="hardhat配置">Hardhat配置</h3>

<p><img src="./attachment/image-20241008210455918.png" alt="" /></p>

<p><img src="./attachment/image-20241008210855082.png" alt="" /></p>

<p><img src="./attachment/image-20241008211058438.png" alt="" /></p>

<h2 id="使用hardhat完成erc2o合约">使用Hardhat完成ERC2O合约</h2>

<h3 id="erc20合约功能设计">ERC20合约功能设计</h3>

<ul>
  <li>Ownert机制
    <ul>
      <li>合约的部署者成为owner</li>
    </ul>
  </li>
  <li>Mint机制
    <ul>
      <li>每个地址只能mint一次，mint数量为一个确定的常量</li>
      <li>如果某个地址的币被销毁，那么可以重新获得一次mint机会</li>
      <li>合约的owner在部署时获得一定量的初始代币</li>
    </ul>
  </li>
  <li>转移机制
    <ul>
      <li>不能转移</li>
    </ul>
  </li>
  <li>Burn机制
    <ul>
      <li>只有合约的owner可以burn掉任意地址的代币</li>
    </ul>
  </li>
</ul>

<h3 id="完成erc20合约">完成ERC20合约</h3>

<p>准备-安装@openzeppelin/,contracts</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> @openzeppelin/contracts 
</code></pre></div></div>

<p>引入并继承ERC20合约</p>

<pre><code class="language-solidity">import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
contract MyToken is ERC20
</code></pre>

<p>可以直接使用ERC20的基础功能，不必重复实现</p>

<p><img src="./attachment/image-20241008212011528.png" alt="" /></p>

<p><img src="./attachment/image-20241008212133975.png" alt="" /></p>

<p><img src="./attachment/image-20241008212203652.png" alt="" /></p>

<p><img src="./attachment/image-20241008212226319.png" alt="" /></p>

<h3 id="测试">测试</h3>

<h4 id="设计测试内容">设计测试内容</h4>

<ul>
  <li>Deployment
    <ul>
      <li>Correct owner正确的ownert地址</li>
      <li>Initial values正确的代币name和symbol</li>
      <li>Initial mint初始化mint了代币给owneri地址</li>
    </ul>
  </li>
  <li>Mint &amp; Burn
    <ul>
      <li>Mint token可以正常mint一次，不可以再次重复mint</li>
      <li>Burn token只能被owneri调用一次burn,不可以被其他地址调用，不可以多次重复调用</li>
    </ul>
  </li>
  <li>Transfer
    <ul>
      <li>Not allowed to transfer不可以转移</li>
    </ul>
  </li>
</ul>

<p><img src="./attachment/image-20241008212812393.png" alt="" /></p>

<h4 id="书写测试">书写测试</h4>

<p><img src="./attachment/image-20241008212943758.png" alt="" /></p>

<p><img src="./attachment/image-20241008213409161.png" alt="" /></p>

<p><img src="./attachment/image-20241008213730611.png" alt="" /></p>

<p><img src="attachment/image-20241008213819995.png" alt="" /></p>

<p><img src="./attachment/image-20241008214220047.png" alt="" /></p>

<p><img src="./attachment/image-20241008214348576.png" alt="" /></p>

<p><img src="attachment/image-20241008214431884.png" alt="" /></p>

<h2 id="hardhat脚本与任务">Hardhat脚本与任务</h2>

<h3 id="脚本与任务">脚本与任务</h3>

<p>启动本地网络localhost</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat node
</code></pre></div></div>

<p><img src="./attachment/image-20241008214806452.png" alt="" /></p>

<p>用Script部署合约到localhost</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat run scripts/deploy.ts--network localhost
</code></pre></div></div>

<p><img src="./attachment/image-20241008214922422.png" alt="" /></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat deploy--network localhost
</code></pre></div></div>

<p><img src="./attachment/image-20241008215146178.png" alt="" /></p>

<h3 id="用任务与合约交互">用任务与合约交互</h3>

<p>用Task来完成mint</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat mint--network localhost
</code></pre></div></div>

<p><img src="./attachment/image-20241008215525202.png" alt="" /></p>

<p>用Task来查看余额</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat balance--network localhost--address <span class="o">{</span>address<span class="o">}</span>
</code></pre></div></div>

<p><img src="./attachment/image-20241008215712781.png" alt="" /></p>

<h3 id="部署到bnb-testnet">部署到BNB Testnet</h3>

<p>部署</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat deploy--network bnbtest
</code></pre></div></div>

<p>验证合约</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx hardhat verify <span class="nt">--network</span> bnbtest--address Oxabc123
</code></pre></div></div>

<p><img src="./attachment/image-20241008215831441.png" alt="" /></p>


            <div class="lesson-footer">
                <p>最后更新于 </p>
                
            </div>

            <div class="pagination">
                
                
            </div>
        </main>

        <!-- 右侧目录 -->
        <aside class="toc" id="toc">
            <h2>本页目录</h2>
            <nav class="toc-nav">
                <ul class="toc-list" id="tocList">
                    <!-- 目录项将由 JavaScript 动态生成 -->
                </ul>
            </nav>
        </aside>
    </div>

    <!-- 侧边栏切换按钮 -->
    <button class="sidebar-toggle" id="sidebarToggle" aria-label="切换目录">
        <svg viewBox="0 0 24 24" fill="white">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
        </svg>
    </button>

    <footer>
    <div class="container">
        <p>&copy; 2025 Top3 Academy. All rights reserved. | <a
                href="https://learnweb3.top">learnweb3.top</a> | Made by <a href="https://x.com/Onefly"
                target="_blank">Onefly</a></p>
    </div>
</footer>
    <script>
    (function () {
        // 主题切换
        const themeToggle = document.getElementById('themeToggle');
        const prismLight = document.getElementById('prism-light');
        const prismDark = document.getElementById('prism-dark');

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            if (theme === 'dark') {
                if (prismLight) prismLight.disabled = true;
                if (prismDark) prismDark.disabled = false;
            } else {
                if (prismLight) prismLight.disabled = false;
                if (prismDark) prismDark.disabled = true;
            }
        }

        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme);

        if (themeToggle) {
            themeToggle.addEventListener('click', function () {
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
                setTheme(currentTheme === 'dark' ? 'light' : 'dark');
            });
        }

        // 移动端菜单
        const menuToggle = document.getElementById('menuToggle');
        const mainNav = document.getElementById('mainNav');

        if (menuToggle && mainNav) {
            menuToggle.addEventListener('click', function () {
                this.classList.toggle('active');
                mainNav.classList.toggle('open');
                document.body.style.overflow = mainNav.classList.contains('open') ? 'hidden' : '';
            });

            mainNav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    menuToggle.classList.remove('active');
                    mainNav.classList.remove('open');
                    document.body.style.overflow = '';
                });
            });
        }
    })();
</script>

<!-- Mermaid JS -->
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

    // Unified Mermaid Loader
    (function () {
        async function initMermaid() {
            // Avoid running twice
            if (window._mermaidInitialized) return;
            window._mermaidInitialized = true;

            // 1. Find all potential Mermaid blocks
            // Strategy: Look for 'language-mermaid' class OR content starting with keywords
            const codeBlocks = document.querySelectorAll('pre code');

            const keywords = ['sequenceDiagram', 'mindmap', 'graph', 'flowchart', 'classDiagram', 'gantt', 'pie'];
            const mermaidNodes = [];

            codeBlocks.forEach(block => {
                let isMermaid = false;
                const text = block.textContent.trim();

                // Check class
                if (block.classList.contains('language-mermaid') || block.closest('.language-mermaid')) {
                    isMermaid = true;
                }
                // Check content keywords
                else {
                    for (const kw of keywords) {
                        if (text.startsWith(kw)) {
                            isMermaid = true;
                            break;
                        }
                    }
                }

                if (isMermaid) {
                    const div = document.createElement('div');
                    div.className = 'mermaid';
                    div.style.textAlign = 'center';
                    div.style.background = 'var(--bg-tertiary)';
                    div.style.padding = '20px';
                    div.style.borderRadius = '12px';
                    div.textContent = text;
                    mermaidNodes.push({ block, div });
                }
            });

            // 2. Perform replacements
            mermaidNodes.forEach(({ block, div }) => {
                const pre = block.closest('pre');
                const wrapper = pre.closest('div.highlighter-rouge, div.highlight');
                if (wrapper) {
                    wrapper.replaceWith(div);
                } else if (pre) {
                    pre.replaceWith(div);
                } else {
                    block.replaceWith(div);
                }
            });

            // 3. Initialize and Run Mermaid
            // We use var() for colors that change between themes to ensure dynamic switching works
            const style = getComputedStyle(document.body);
            const primary = style.getPropertyValue('--primary').trim();

            mermaid.initialize({
                startOnLoad: false,
                theme: 'base',
                themeVariables: {
                    fontFamily: 'Inter, sans-serif',
                    primaryColor: primary,
                    primaryTextColor: '#fff',
                    primaryBorderColor: primary,
                    lineColor: 'var(--text-primary)',
                    secondaryColor: 'var(--bg-secondary)',
                    tertiaryColor: 'var(--bg-tertiary)',
                    textColor: 'var(--text-primary)',
                    signalTextColor: 'var(--text-primary)',
                    actorTextColor: '#fff',
                    noteTextColor: 'var(--text-primary)',
                    loopTextColor: 'var(--text-primary)',
                    activationBorderColor: primary
                }
            });

            const allMermaidDivs = document.querySelectorAll('.mermaid');
            if (allMermaidDivs.length > 0) {
                await mermaid.run({
                    querySelector: '.mermaid'
                });
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initMermaid);
        } else {
            initMermaid();
        }
    })();
</script>

    <!-- 侧边栏和目录脚本 -->
    <script>
        (function () {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebarOverlay = document.getElementById('sidebarOverlay');

            function toggleSidebar() {
                sidebar.classList.toggle('open');
                sidebarOverlay.classList.toggle('visible');
                document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : '';
            }

            function closeSidebar() {
                sidebar.classList.remove('open');
                sidebarOverlay.classList.remove('visible');
                document.body.style.overflow = '';
            }

            if (sidebarToggle) sidebarToggle.addEventListener('click', toggleSidebar);
            if (sidebarOverlay) sidebarOverlay.addEventListener('click', closeSidebar);

            document.querySelectorAll('.lesson-nav a').forEach(link => {
                link.addEventListener('click', closeSidebar);
            });

            document.addEventListener('keydown', e => {
                if (e.key === 'Escape') closeSidebar;
            });

            // ============================================
            // TOC (右侧目录) 生成和高亮
            // ============================================
            const content = document.querySelector('.content');
            const tocList = document.getElementById('tocList');
            const toc = document.getElementById('toc');

            if (content && tocList) {
                // 提取所有 h2 和 h3 标题
                const headings = content.querySelectorAll('h2, h3');

                if (headings.length > 0) {
                    headings.forEach((heading, index) => {
                        // 为标题添加 ID（如果没有的话）
                        if (!heading.id) {
                            heading.id = `heading-${index}`;
                        }

                        // 创建目录项
                        const li = document.createElement('li');
                        li.className = `toc-item toc-${heading.tagName.toLowerCase()}`;

                        const a = document.createElement('a');
                        a.className = 'toc-link';
                        a.href = `#${heading.id}`;
                        a.textContent = heading.textContent;
                        a.dataset.target = heading.id;

                        // 平滑滚动
                        a.addEventListener('click', (e) => {
                            e.preventDefault();
                            heading.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            // 更新 URL hash
                            history.pushState(null, null, `#${heading.id}`);
                        });

                        li.appendChild(a);
                        tocList.appendChild(li);
                    });

                    // 滚动高亮
                    let throttleTimer;
                    const throttle = (callback, time) => {
                        if (throttleTimer) return;
                        throttleTimer = setTimeout(() => {
                            callback();
                            throttleTimer = null;
                        }, time);
                    };

                    const highlightTOC = () => {
                        const scrollPos = window.scrollY + 100; // 偏移量
                        let currentHeading = null;

                        headings.forEach(heading => {
                            const top = heading.offsetTop;
                            if (scrollPos >= top) {
                                currentHeading = heading;
                            }
                        });

                        // 移除所有高亮
                        document.querySelectorAll('.toc-link').forEach(link => {
                            link.classList.remove('active');
                        });

                        // 添加当前高亮
                        if (currentHeading) {
                            const activeLink = document.querySelector(`.toc-link[data-target="${currentHeading.id}"]`);
                            if (activeLink) {
                                activeLink.classList.add('active');
                            }
                        }
                    };

                    window.addEventListener('scroll', () => {
                        throttle(highlightTOC, 100);
                    });

                    // 初始高亮
                    highlightTOC();
                } else {
                    // 如果没有标题，隐藏TOC
                    if (toc) toc.style.display = 'none';
                }
            }
        })();
    </script>
</body>

</html>